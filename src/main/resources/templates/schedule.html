<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<style>
    .hr-blurry {
        border: 0;
        height: 1px;
        background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));
        width: 100%;
    }

    .bottom-line {
        margin-top: auto;
    }

    /* Add space between rows */
    tr.add-space {
        margin-bottom: 40px; /* Adjust the value as needed */
    }
</style>
<head>
    <meta charset="UTF-8">
    <title>Users</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link href="https://cdn.datatables.net/v/bs5/jq-3.7.0/dt-1.13.6/datatables.min.css" rel="stylesheet">
</head>
<body>
<div th:replace="~{fragments/header :: header}"></div>

<div class="d-flex">
    <div th:replace="~{fragments/side-panel :: aside}"></div>
    <div class="container shadow mb-5 bg-body rounded" style="margin-top: 30px; margin-left: 50px;">
        <h2>Schedule</h2>
        <div>
            <span>
                Filters:
            </span>
            <div>
                <label>
                    <span>Group</span>
                    <select th:field="*{currentGroup}"
                            id="groupSelect">
                        <option value="">All</option>
                        <option th:each="group : ${groups}"
                                th:value="${group.id}"
                                th:text="${group.name}">
                        </option>
                    </select>
                </label>
                <label>
                    <span>Course</span>
                    <select th:field="*{currentCourse}"
                            id="courseSelect">
                        <option value="">All</option>
                        <option th:each="course : ${courses}"
                                th:value="${course.id}"
                                th:text="${course.name}">
                        </option>
                    </select>
                </label>
                <label>
                    <span>Teacher</span>
                    <select th:field="*{currentTeacher}"
                    id="teacherSelect"
                    >
                        <option value="">All</option>
                        <option th:each="teacher : ${teachers}"
                                th:value="${teacher.id}"
                                th:text="${teacher.firstName +' '+ teacher.lastName}"
                                th:selected="${currentTeacher}">
                        </option>
                    </select>
                </label>

            </div>
            <span>
                Checkboxes:
            </span>

            <div>
                <label>Group
                    <input type="checkbox" th:checked="${showGroup}"/>
                </label>
                <label>Classroom
                    <input type="checkbox" th:checked="${showClassroom}"/>
                </label>
                <label>Course
                    <input type="checkbox" th:checked="${showCourse}"/>
                </label>
                <label>Teacher
                    <input type="checkbox" th:checked="${showTeacher}"/>
                </label>
            </div>


        </div>
        <table>
            <thead>
            <tr>
                <th>Lesson</th>
                <th th:each="day : ${days}" th:text="${day}">
                </th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="lessonNumber : ${lessonNumbers}"
                class="add-space">
                <td th:text="${lessonNumber}"></td>
                <td th:each="day : ${days}">
                    <div
                            th:with="cell=${universitySchedule.getCell(day, lessonNumber)}">
                        <div th:each="lesson : ${cell.lessons}"
                             class="shadow rounded" style="padding: 5px;">
                            <span th:text="${lesson.course.name}"></span><br/>
                            <span th:text="${lesson.group.name}"></span><br/>
                            <span th:text="${lesson.classroom.number}"></span>
                        </div>
                    </div>
                </td>
                <!-- Horizontal line separator within the loop -->
                <td>
                    <div class="hr" style="margin-top: auto;"></div>
                </td>
            </tr>

            </tbody>
        </table>
    </div>

</div>
<script th:inline="javascript">
    function generateUrl(urlParams) {
        let str = "";
        urlParams.forEach((value, key) => {
            str = str + key + "=" + value + "&";
        })
        if (str !== "") {
           str= str.substring(0, str.length - 1);
        }
        return 'schedule?' + str;
    }

    document.getElementById("groupSelect").onchange = function () {
        const groupId = this.value;
        const urlParams = new URLSearchParams(window.location.search);
        urlParams.set("groupId", groupId);
        window.location.href = generateUrl(urlParams);
    }

    document.getElementById("courseSelect").onchange = function () {
        const courseId = this.value;
        const urlParams = new URLSearchParams(window.location.search);
        urlParams.set("courseId", courseId);
        window.location.href = generateUrl(urlParams);
    }

    document.getElementById("teacherSelect").onchange = function () {
        const teacherId = this.value;

        const urlParams = new URLSearchParams(window.location.search);
        urlParams.set("teacherId", teacherId);
        window.location.href = generateUrl(urlParams);
    }

</script>
</body>
</html>